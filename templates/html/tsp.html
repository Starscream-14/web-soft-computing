<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Traveling Salesman (TSP) - Soft Computing</title>
    <link rel="stylesheet" href="../../static/css/style.css" />
  </head>
  <body class="detail-page tsp-page">
    <header class="site-header">
      <div class="container header-inner">
        <a class="logo" href="../index.html">MyWebsite</a>
        <nav class="site-nav">
          <ul>
            <li><a class="nav-link" href="../index.html#home">Home</a></li>
            <li><a class="nav-link" href="../index.html#about">About</a></li>
            <li>
              <a class="nav-link active" href="../index.html#materi">Materi</a>
            </li>
          </ul>
        </nav>
      </div>
    </header>

    <main>
      <section class="section">
        <div class="container">
          <a href="../index.html#materi" class="back-link"
            ><- Kembali ke Materi</a
          >

          <h1>Traveling Salesman Problem (TSP) - Genetic Algorithm</h1>

          <div class="content-section">
            <p>
              Contoh implementasi Algoritma Genetika untuk menyelesaikan
              Traveling Salesman Problem (TSP) dengan 5 kota. Di bawah tersedia
              source code sebagai referensi, serta form interaktif untuk
              menjalankan demo GA langsung melalui backend.
            </p>
          </div>

          <div class="content-section">
            <div class="code-block-header">ðŸ“„ TSP.py - Full source</div>
            <pre><code id="tspCode">import numpy as np
import pandas as pd
import random

# -----------------------
# 1. Matriks Jarak (dari gambar data yang diberikan)
# -----------------------

# Cities: A, B, C, D, E
cities = ['A', 'B', 'C', 'D', 'E']

# Distance matrix (symmetric). Rows/cols in order A, B, C, D, E
dist_matrix = np.array([
	[0, 7, 5, 9, 9],
	[7, 0, 7, 2, 8],
	[5, 7, 0, 4, 3],
	[9, 2, 4, 0, 6],
	[9, 8, 3, 6, 0]
], dtype=float)

# -----------------------
# 2. Parameter Algoritma
# -----------------------

POP_SIZE = 100
GENERATIONS = 500
TOURNAMENT_K = 5
PC = 0.9
PM = 0.2
ELITE_SIZE = 1

# -----------------------
# 3. Fungsi bantu
# -----------------------

def route_distance(route):
	d = sum(dist_matrix[route[i], route[(i+1)%len(route)]] for i in range(len(route)))
	return d

def create_individual(n):
	ind = list(range(n))
	random.shuffle(ind)
	return ind

def initial_population(size, n):
	return [create_individual(n) for _ in range(size)]

def tournament_selection(pop):
	k = random.sample(pop, TOURNAMENT_K)
	return min(k, key=lambda ind: route_distance(ind))

def ordered_crossover(p1, p2):
	a, b = sorted(random.sample(range(len(p1)), 2))
	child = [-1]*len(p1)
	child[a:b+1] = p1[a:b+1]
	p2_idx = 0
	for i in range(len(p1)):
		if child[i] == -1:
			while p2[p2_idx] in child:
				p2_idx += 1
			child[i] = p2[p2_idx]
	return child

def swap_mutation(ind):
	a, b = random.sample(range(len(ind)), 2)
	ind[a], ind[b] = ind[b], ind[a]

# -----------------------
# 4. Main GA Loop
# -----------------------

pop = initial_population(POP_SIZE, len(cities))
best = min(pop, key=lambda ind: route_distance(ind))
best_dist = route_distance(best)

history = []

for g in range(GENERATIONS):

	new_pop = []

	pop = sorted(pop, key=lambda ind: route_distance(ind))

	if route_distance(pop[0]) < best_dist:
		best = pop[0]
		best_dist = route_distance(best)

	new_pop.extend(pop[:ELITE_SIZE])

	while len(new_pop) < POP_SIZE:

		p1 = tournament_selection(pop)

		p2 = tournament_selection(pop)

		child = ordered_crossover(p1, p2) if random.random() < PC else p1[:]

		if random.random() < PM:
			swap_mutation(child)

		new_pop.append(child)

	pop = new_pop

	history.append(best_dist)

	if g % 50 == 0:
		print(f"Gen {g}: Best Distance = {best_dist:.4f}")

# -----------------------
# 5. Output Hasil
# -----------------------

best_route = [cities[i] for i in best]

print("\nRute terbaik:", " -> ".join(best_route + [best_route[0]]))
print("Jarak total:", best_dist)</code></pre>
          </div>

          <div class="content-section">
            <h3>Jalankan GA TSP (Demo Web)</h3>
            <p>
              Atur parameter berikut lalu klik <strong>Jalankan</strong> untuk
              menjalankan GA pada server:
            </p>
            <form id="tspRunForm" class="demo-form">
              <label
                >Ukuran Populasi:
                <input
                  type="number"
                  name="pop_size"
                  value="100"
                  min="4"
                  max="500"
              /></label>
              <label
                >Generasi:
                <input
                  type="number"
                  name="generations"
                  value="500"
                  min="1"
                  max="2000"
              /></label>
              <label
                >Crossover Rate:
                <input
                  type="number"
                  step="0.01"
                  name="pc"
                  value="0.9"
                  min="0"
                  max="1"
              /></label>
              <label
                >Mutation Rate:
                <input
                  type="number"
                  step="0.01"
                  name="pm"
                  value="0.2"
                  min="0"
                  max="1"
              /></label>
              <label
                >Elitism (jumlah):
                <input
                  type="number"
                  name="elite_size"
                  value="1"
                  min="0"
                  max="50"
              /></label>
              <button type="submit">Jalankan</button>
            </form>
            <div id="tspResult" class="result"></div>
          </div>
        </div>
      </section>
    </main>

    <footer class="site-footer">
      <div class="container">
        <p>&copy; <span id="year"></span> MyWebsite - Soft Computing</p>
      </div>
    </footer>

    <script src="../../static/js/script.js"></script>
  </body>
</html>
